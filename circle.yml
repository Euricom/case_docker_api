machine:
    services:
        - docker

# dependencies:
#     override:
#         - docker info

deployment:

    development:
        branch: develop
        commands:
            - docker build -t example123 .
            - docker save -o $CIRCLE_ARTIFACTS/example.tar example123
            - docker login --email=_ --username=_ --password=$HEROKU_API_KEY registry.heroku.com
            - docker tag example123 registry.heroku.com/example123-staging/web
            - docker push registry.heroku.com/example123/web
    
    production:
        branch: master
        commands:
            - sh deploy/deploy_staging.sh
